<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>mosaic-pm/specification-discussions/20191206-etherscan-verification · MosaicDAO</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Etherscan contract verification tool"/><meta name="docsearch:version" content="next"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="mosaic-pm/specification-discussions/20191206-etherscan-verification · MosaicDAO"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jayeshbairagi.github.io/mosaicdaoWeb/"/><meta property="og:description" content="# Etherscan contract verification tool"/><meta property="og:image" content="https://jayeshbairagi.github.io/mosaicdaoWeb/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://jayeshbairagi.github.io/mosaicdaoWeb/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/mosaicdaoWeb/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://jayeshbairagi.github.io/mosaicdaoWeb/blog/atom.xml" title="MosaicDAO Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://jayeshbairagi.github.io/mosaicdaoWeb/blog/feed.xml" title="MosaicDAO Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/mosaicdaoWeb/js/scrollSpy.js"></script><link rel="stylesheet" href="/mosaicdaoWeb/css/main.css"/><script src="/mosaicdaoWeb/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/mosaicdaoWeb/"><img class="logo" src="/mosaicdaoWeb/img/favicon.ico" alt="MosaicDAO"/><h2 class="headerTitleWithLogo">MosaicDAO</h2></a><a href="/mosaicdaoWeb/versions"><h3>next</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/mosaicdaoWeb/docs/next/mosaic-pm/experience/doc1" target="_self">Docs</a></li><li class=""><a href="/mosaicdaoWeb/help" target="_self">Help</a></li><li class=""><a href="/mosaicdaoWeb/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">mosaic-pm/specification-discussions/20191206-etherscan-verification</h1></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="etherscan-contract-verification-tool"></a><a href="#etherscan-contract-verification-tool" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Etherscan contract verification tool</h1>
<p>Aim of the tool is to automate and verify contracts on Etherscan (mainnet, Ropsten and Goerli).</p>
<h2><a class="anchor" aria-hidden="true" id="origin-contracts-to-verify-per-auxiliary-chain"></a><a href="#origin-contracts-to-verify-per-auxiliary-chain" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Origin contracts to verify per auxiliary chain</h2>
<ul>
<li>Anchor</li>
<li>AnchorOrganization</li>
<li>OSTGatewayOrganization</li>
<li>OSTEIP20Gateway</li>
<li>MerklePatriciaProof</li>
<li>MessageBus</li>
<li>GatewayLib</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="origin-contracts-to-verify-per-token"></a><a href="#origin-contracts-to-verify-per-token" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Origin contracts to verify per token</h2>
<ul>
<li>ERC20GatewayOrganization</li>
<li>ERC20Gateway</li>
<li>ValueBrandedToken</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="tool-to-automate-contracts-verification-on-etherscan"></a><a href="#tool-to-automate-contracts-verification-on-etherscan" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tool to automate contracts verification on etherscan</h2>
<ul>
<li><p>Proposed command</p>
<pre><code class="hljs css language-bash">npm run verify-contract &lt;apiKey&gt; &lt;network&gt; &lt;githubRepoUrl&gt; &lt;contractName&gt; &lt;contractAddress&gt; &lt;contractCreationTxHash&gt; &lt;byteCode&gt; &lt;libraryContractConfig&gt;
</code></pre>
<ul>
<li><b>apiKey</b>: Etherscan API key</li>
<li><b>network</b>: Network where contract is deployed. e.g. &quot;mainnet&quot;, &quot;ropsten&quot;, &quot;rinkeby&quot;, &quot;kovan&quot;, &quot;goerli&quot;</li>
<li><b>GithubRepoUrl</b>: Github exact tag/release contract repository which was used to deploy the contracts. Supported repositories:
<ul>
<li>mosaic-contracts</li>
<li>brandedtoken-contracts</li>
<li>openst-contracts</li>
</ul></li>
<li><b>contractName</b>: Contract which is to be verified on etherscan</li>
<li><b>contractAddress</b>: Contract address to verify</li>
<li><b>contractCreationTxHash</b>: Contract's creation transaction hash</li>
<li><b>byteCode</b>: Bytecode which was used to deploy the contracts. This parameter is optional after <code>contract compilation</code> bugs are fixed</li>
<li><b>libraryContractConfig</b>: It's an optional field. File path which contains verified library contracts details in json format. If library contracts are not verified, they need to be verified first. e.g.
<pre><code class="hljs">    {
      <span class="hljs-attr">"MerklePatriciaProof"</span>: <span class="hljs-string">"&lt;contractAddress&gt;"</span>,
      <span class="hljs-attr">"MessageBus"</span>: <span class="hljs-string">"&lt;contractAddress&gt;"</span>
  }
</code></pre></li>
</ul></li>
<li><p>Implementation Details</p>
<ul>
<li>The tool will clone the given github release/tag repository. Supported repositories:
<ul>
<li>mosaic-contracts</li>
<li>brandedtoken-contracts</li>
<li>openst-contracts</li>
</ul></li>
<li>Run <code>npm ci</code></li>
<li><code>npm run compile</code> needs to run. This will populate compiled contract build files in <code>contract/build</code> directory.
<ul>
<li>Note: Make sure contracts are compiled with exact solc version which was deployed.</li>
</ul></li>
<li>Update contract/build/<contractName>.json file network section:</li>
</ul>
<pre><code class="hljs css language-json">"networks": {
    "1": {
      "address": "&lt;contractAddress&gt;",
      "transactionHash": "&lt;contractCreationTxHash&gt;",
      "links": {}
    }
</code></pre>
<ul>
<li>To verify contracts which have links to library contracts, library contract addresses needs to be specified in the links section.
Library contracts should be verified before verifying linked library contract. e.g.</li>
</ul>
<pre><code class="hljs css language-json">"networks": {
    "1": {
      "address": "&lt;gatewayContractAddress&gt;",
      "transactionHash": "&lt;gatewayContractCreationTxHash&gt;",
      "links": {
          "MerklePatriciaProof": "&lt;contractAddress&gt;",
          "MessageBus": "&lt;contractAddress&gt;"
      }
    }
</code></pre></li>
<li><p><code>verify-on-etherscan.verify</code> method will be called from inside the script</p>
<pre><code class="hljs css language-javascript">    <span class="hljs-keyword">const</span> verify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'verify-on-etherscan'</span>);
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> verify({
      cwd,
      artifacts,
      apiKey,
      web3,
      network,
      useFetch,
      optimizer,
      output,
      delay,
      logger,
      verbose
    })
</code></pre></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="notes"></a><a href="#notes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Notes</h2>
<ul>
<li>Rotate etherscan API key</li>
<li>BUG: brandedtoken-contracts and MosaicContracts is using different solc version(not 0.5.0) for contracts compilation.
<ul>
<li>mosaic-contracts PR: <a href="https://github.com/mosaicdao/mosaic-contracts/pull/802">https://github.com/mosaicdao/mosaic-contracts/pull/802</a></li>
<li>brandedtoken-contracts PR: <a href="https://github.com/OpenST/brandedtoken-contracts/pull/181">https://github.com/OpenST/brandedtoken-contracts/pull/181</a></li>
</ul></li>
<li>Truffle &quot;beta&quot; version is taking latest beta version for compilation</li>
<li>Verification of contracts should be done as soon as they are deployed</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="chain-contracts-verification"></a><a href="#chain-contracts-verification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Chain contracts verification</h2>
<ul>
<li><p>Anchor organization - Done
<a href="https://etherscan.io/address/0xc450a2fa865972fb7a07acad6cf6c3654e37c617#code">https://etherscan.io/address/0xc450a2fa865972fb7a07acad6cf6c3654e37c617#code</a>
solc version: v0.5.2+commit.1df8f40c</p></li>
<li><p>OSTGateway organization - Done
<a href="https://etherscan.io/address/0x813bcae43e1aff7466d9d34a8163a2bf5216dc1f">https://etherscan.io/address/0x813bcae43e1aff7466d9d34a8163a2bf5216dc1f</a>
solc version: v0.5.2+commit.1df8f40c</p></li>
<li><p>OSTGateway - Done
<a href="https://etherscan.io/address/0xe0a3929c6947cdc091e6e6725826a09615062131#code">https://etherscan.io/address/0xe0a3929c6947cdc091e6e6725826a09615062131#code</a>
compiler version: v0.5.3+commit.10d17f24</p></li>
<li><p>Anchor - Done
<a href="https://etherscan.io/address/0x981884d4369f7b7892d8c279d2125daf7422d9e0">https://etherscan.io/address/0x981884d4369f7b7892d8c279d2125daf7422d9e0</a>
compiler version: v0.5.3+commit.10d17f24</p></li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="pepo-contracts-verification"></a><a href="#pepo-contracts-verification" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pepo contracts verification</h2>
<ul>
<li><p>BrandedToken - DONE
<a href="https://etherscan.io/address/0x8d3d262fb1139d5d55d9ccbe7fff5fc45f242184#code">https://etherscan.io/address/0x8d3d262fb1139d5d55d9ccbe7fff5fc45f242184#code</a><br>
solc version: v0.5.0+commit.1d4f565a</p></li>
<li><p>Organization - Done
<a href="https://etherscan.io/address/0x377cecea5900b9483320dff639ca49a7e2df15d1#code">https://etherscan.io/address/0x377cecea5900b9483320dff639ca49a7e2df15d1#code</a>
solc version: v0.5.2+commit.1df8f40c</p></li>
<li><p>MerklePatriciaProof - Done
<a href="https://etherscan.io/address/0x30db9dd1875dbea601ba061e81dd88325d68fd18">https://etherscan.io/address/0x30db9dd1875dbea601ba061e81dd88325d68fd18</a>
solc version: v0.5.2+commit.1df8f40c</p></li>
<li><p>MessageBus - Done
<a href="https://etherscan.io/address/0x0b71bb83d2814633f7dfeb9cb5c4c2e63be215ed">https://etherscan.io/address/0x0b71bb83d2814633f7dfeb9cb5c4c2e63be215ed</a>
solc version: v0.5.3+commit.10d17f24</p></li>
<li><p>GatewayLib - Done
<a href="https://etherscan.io/address/0x1c9e18c8ab156753f7eca95d8c042f7842aaf09e">https://etherscan.io/address/0x1c9e18c8ab156753f7eca95d8c042f7842aaf09e</a>
compiler version: v0.5.3+commit.10d17f24</p></li>
<li><p>EIP20Gateway - Done
<a href="https://etherscan.io/address/0x73ae859256da871afd09bf4d45fd60936b15d8ea">https://etherscan.io/address/0x73ae859256da871afd09bf4d45fd60936b15d8ea</a>
compiler version: v0.5.3+commit.10d17f24</p></li>
</ul>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#origin-contracts-to-verify-per-auxiliary-chain">Origin contracts to verify per auxiliary chain</a></li><li><a href="#origin-contracts-to-verify-per-token">Origin contracts to verify per token</a></li><li><a href="#tool-to-automate-contracts-verification-on-etherscan">Tool to automate contracts verification on etherscan</a></li><li><a href="#notes">Notes</a></li><li><a href="#chain-contracts-verification">Chain contracts verification</a></li><li><a href="#pepo-contracts-verification">Pepo contracts verification</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/mosaicdaoWeb/" class="nav-home"><img src="/mosaicdaoWeb/img/favicon.ico" alt="MosaicDAO" width="66" height="58"/></a><div><h5>Docs</h5><a href="/mosaicdaoWeb/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/mosaicdaoWeb/docs/en/doc2.html">Guides (or other categories)</a><a href="/mosaicdaoWeb/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/mosaicdaoWeb/en/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/mosaicdaoWeb/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/mosaicdaoWeb/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Your Name or Your Company Name</section></footer></div></body></html>